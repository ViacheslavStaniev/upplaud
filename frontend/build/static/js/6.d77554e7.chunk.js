"use strict";(self.webpackChunkpdsq_frontend=self.webpackChunkpdsq_frontend||[]).push([[6],{85379:(e,o,l)=>{l.d(o,{Z:()=>a});var s=l(24925),n=l(92143),t=l(79286),i=l(80184);function a(e){let{items:o=[],defaultActive:l="",marginBottom:a=!0}=e;return(0,i.jsx)(s.Z,{items:o,bordered:!1,className:"bg-F7F3F9 ".concat(a?"mb-2":""),defaultActiveKey:l?[l]:[],expandIcon:e=>{let{isActive:o}=e;return o?(0,i.jsx)(n.Z,{}):(0,i.jsx)(t.Z,{})}})}},69006:(e,o,l)=>{l.r(o),l.d(o,{default:()=>T});var s=l(94545),n=l(83769),t=l(60245),i=l(50284),a=l(46417),c=l(72791),r=l(38072),d=l(57689),u=l(11087),v=l(18406),m=l(48080),h=l(78302),p=l(67049),f=l(66106),g=l(30914),y=l(88715),x=l(40959),b=l(93070),j=l(49389),w=l(2556),k=l(49189),S=l(36473),Z=l(49367),N=l(80184);const{Text:C,Title:I,Paragraph:P}=h.default;function T(){const{guestId:e}=(0,d.UO)(),[o,l]=(0,c.useState)({poll:null,errorMsg:"",loading:!1,validatedPolls:{},passwordValidated:!1}),{poll:t,errorMsg:a,loading:r,validatedPolls:u,passwordValidated:v}=o,h=(null===t||void 0===t?void 0:t.guest)||{},k=e=>l((o=>({...o,...e})));return(0,c.useEffect)((()=>{if(e){const o=JSON.parse(window.localStorage.getItem("validatedPolls"))||{},l=o[e]||!1;k({loading:!0,passwordValidated:l,validatedPolls:o}),(0,m.Kd)(e).then((e=>k({poll:e}))).catch(console.error).finally((()=>k({loading:!1})))}return()=>{k({poll:null,loading:!1})}}),[e]),r?(0,N.jsx)(i.Z,{}):e?(0,N.jsxs)(p.ZP,{theme:{token:{fontSize:16}},children:[(0,N.jsx)(n.Z,{title:"Guest Acceptance"}),(0,N.jsxs)(f.Z,{className:"h-100vh guest-acceptance",children:[(0,N.jsxs)(g.Z,{span:5,className:"p-2 leftbg",children:[(0,N.jsx)(s.Z,{rootClassName:"sidebar-navlogo"}),(0,N.jsxs)("div",{className:"bg-white p-2 br-8px mt-2",children:[(0,N.jsx)(I,{level:3,className:"text-center color-36c102",children:"How does Upplaud grow our audience?"}),(0,N.jsx)(I,{level:5,children:"It's proven that when we ask others for input, we get to:"}),(0,N.jsx)(y.Z,{size:"small",className:"mb-4",dataSource:["- Make them feel part of us","- Give them what they want.","- They'll share us more:","- We grow our reach & impact","- We do business better!"],renderItem:e=>(0,N.jsx)(y.Z.Item,{className:"border-0",children:e})}),(0,N.jsx)(P,{children:"Upplaud captures voter referrals, email addresses & offers rewards to voters; while pulling interest from multiple sources: Co-presenters' Facebook, LinkedIn, email, presentations, etc."})]})]}),(0,N.jsx)(g.Z,{span:19,className:"p-4",children:t&&h&&(0,N.jsx)(_,{poll:t,guest:h})})]}),(0,N.jsx)(x.Z,{footer:!1,closable:!1,maskClosable:!1,open:!v,styles:{mask:{backgroundColor:"#fdeffff0"}},children:(0,N.jsxs)("div",{className:"p-2",children:[(0,N.jsx)(I,{level:3,className:"mt-0",children:"Password Required!"}),a&&(0,N.jsx)(P,{type:"danger",children:a}),(0,N.jsxs)(b.Z,{size:"large",layout:"vertical",initialValues:{password:""},onFinish:o=>{let{password:l=""}=o;if((null===l||void 0===l?void 0:l.trim())===(null===t||void 0===t?void 0:t.password)){const o={...u,[e]:!0};window.localStorage.setItem("validatedPolls",JSON.stringify(o)),k({passwordValidated:!0,newValidatedPolls:o})}else k({errorMsg:"Invalid password!"})},children:[(0,N.jsx)(b.Z.Item,{name:"password",label:"Enter your password",children:(0,N.jsx)(j.Z.Password,{placeholder:"Enter your password"})}),(0,N.jsx)(w.ZP,{type:"primary",htmlType:"submit",children:"Submit"})]})]})})]}):(0,N.jsx)(d.Fg,{to:"/404"})}function _(e){let{poll:o,guest:l}=e;const[s]=b.Z.useForm(),{modal:n,notification:i}=k.Z.useApp(),[d,h]=(0,c.useState)(!1),[p,f]=(0,c.useState)(!1),g=(0,v.K6)((null===l||void 0===l?void 0:l.socialAccounts)||[]);(0,c.useEffect)((()=>{h(!0),(0,m.nz)(null===l||void 0===l?void 0:l._id,null===o||void 0===o?void 0:o._id).then((e=>{s.setFieldsValue({socials:(null===e||void 0===e?void 0:e.length)>0?e:g})})).catch(console.error).finally((()=>h(!1)))}),[null===l||void 0===l?void 0:l._id,null===o||void 0===o?void 0:o._id]);return(0,N.jsxs)("div",{className:"guest-acceptance-content",children:[(0,N.jsxs)(I,{level:2,className:"color-6b0d88 fw-600 m-0 mb-2",children:["Hi ",null===l||void 0===l?void 0:l.firstName,", I'm looking forward to doing ",(null===o||void 0===o?void 0:o.presentationName)||"an event"," ","with you!"]}),(0,N.jsx)(I,{level:3,className:"m-0 mb-2",children:"Let's grow the best audience for us\u2026"}),(0,N.jsx)(I,{level:3,className:"m-0 mb-2",children:"By inviting our connections to vote & share our topics:"}),(0,N.jsxs)(S.Z,{children:[(0,N.jsx)(A,{index:1,className:"color-2196F3",title:"Connect your social media (as I have already)...",avatarStyles:{backgroundColor:"#2196f3",color:"#ffffff"}}),(0,N.jsx)(t.Z,{user:l,btnSize:"default",showTitle:!1,className:"mb-4 mt-2"}),(0,N.jsx)(A,{index:2,type:"secondary",title:"Optional: Reward for voting..."}),(0,N.jsxs)("div",{className:"flex-item gap-1 mb-4",children:[(0,N.jsx)(C,{className:"minw-fit-content",children:"Website address of your gift offer:"}),(0,N.jsxs)(b.Z,{layout:"inline",onFinish:e=>{let{guestOfferUrl:l}=e;f(!0),(0,m.$X)(null===o||void 0===o?void 0:o._id,{guestOfferUrl:l}).then((e=>{let{msg:o}=e;return i.success({message:"Success",description:o})})).catch((e=>i.error({message:"Error",description:null===e||void 0===e?void 0:e.message}))).finally((()=>f(!1)))},className:"flex-item gap-1 flex-nowrap",initialValues:{guestOfferUrl:null===o||void 0===o?void 0:o.guestOfferUrl},children:[(0,N.jsx)(b.Z.Item,{noStyle:!0,name:"guestOfferUrl",rules:[{required:!0,message:"Please enter the offer url."}],children:(0,N.jsx)(j.Z,{type:"url",placeholder:"Enter your offer url"})}),(0,N.jsx)(b.Z.Item,{noStyle:!0,children:(0,N.jsx)(w.ZP,{type:"primary",htmlType:"submit",loading:p,children:"Save"})})]})]}),(0,N.jsx)(A,{index:3,type:"secondary",title:"Confirm: Posting frequency...",avatarStyles:{backgroundColor:"#9e9e9e",color:"#ffffff"}}),(0,N.jsxs)(P,{children:["To reach the most people, we'll repeat our Upplaud until"," ",(0,v.fh)(null===o||void 0===o?void 0:o.recordingDate),":"]}),(0,N.jsxs)(b.Z,{form:s,size:"large",className:"mb-4",labelWrap:!0,labelAlign:"left",layout:"horizontal",initialValues:{socials:g},onFinish:e=>{h(!0),(0,m.CN)(null===l||void 0===l?void 0:l._id,null===o||void 0===o?void 0:o._id,e.socials).then((()=>n.success({title:"Success",content:"Socials saved successfully."}))).catch((e=>n.error({title:"Error",content:null===e||void 0===e?void 0:e.message}))).finally((()=>h(!1)))},children:[(0,N.jsx)(a.Z,{}),(0,N.jsx)(w.ZP,{loading:d,type:"primary",htmlType:"submit",className:"mt-2",children:"SAVE"})]}),(0,N.jsx)(A,{index:4,title:"Grow even more interest...",avatarStyles:{backgroundColor:"#000000",color:"#ffffff"}}),(0,N.jsxs)(P,{className:"m-0",children:["We should include the following Upplaud voting page in our email blasts, slides & elsewhere:"," ",(0,N.jsx)(u.rU,{to:"/vote/".concat(null===o||void 0===o?void 0:o.uniqueId,"/").concat(null===l||void 0===l?void 0:l.userName),target:"_blank",children:(0,r.a9)("/vote/".concat(null===o||void 0===o?void 0:o.uniqueId,"/").concat(null===l||void 0===l?void 0:l.userName))})]})]})]})}function A(e){let{title:o="",index:l=1,type:s="",className:n="",avatarStyles:t={}}=e;return(0,N.jsxs)(I,{type:s,level:4,className:"flex-item gap-1 ".concat(n),children:[(0,N.jsx)(Z.C,{size:"small",style:t,children:l}),o]})}},60245:(e,o,l)=>{l.d(o,{Z:()=>P});var s=l(66664),n=l(76171),t=l(72791),i=l(33805),a=l(908),c=l(37557),r=l(82621),d=l(87462);const u={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"};var v=l(8711),m=function(e,o){return t.createElement(v.Z,(0,d.Z)({},e,{ref:o,icon:u}))};const h=t.forwardRef(m);const p={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};var f=function(e,o){return t.createElement(v.Z,(0,d.Z)({},e,{ref:o,icon:p}))};const g=t.forwardRef(f);var y=l(78302),x=l(64162),b=l(2556),j=l(71046),w=l(41583),k=l(51678),S=l(80184);const{Title:Z,Text:N}=y.default,{FACEBOOK:C,LINKEDIN:I}=a.SOCIAL_TYPE;function P(e){let{user:o,className:l="",showTitle:d=!0,update:u=(()=>{}),btnSize:v="large"}=e;const m=(null===o||void 0===o?void 0:o.socialAccounts)||[],p=e=>m.find((o=>o.type===e)),[f,y]=(0,t.useState)(!1),[P,T]=(0,t.useState)([]),[_,A]=(0,t.useState)(null);(0,t.useEffect)((()=>{var e,o,l;const s=p(C);var n;s&&null!==s&&void 0!==s&&s.isConnected&&(null!==s&&void 0!==s&&null!==(e=s.page)&&void 0!==e&&e.askToChoose||null!==(o=s.group)&&void 0!==o&&o.askToChoose)&&(A("facebook"),T([null!==s&&void 0!==s&&null!==(n=s.page)&&void 0!==n&&n.askToChoose?"page":"group"]));const t=p(I);t&&null!==t&&void 0!==t&&t.isConnected&&null!==t&&void 0!==t&&null!==(l=t.page)&&void 0!==l&&l.askToChoose&&(T(["page"]),A("linkedin"))}),[]);const E=new URLSearchParams(window.location.search).get("isConnected")||"0";(0,t.useEffect)((()=>{"1"===E&&x.ZP.success({message:"Success",description:"You have successfully connected your social media account."})}),[E]);const O=e=>{var o;return(null===(o=p(e))||void 0===o?void 0:o.isConnected)||!1},q=function(e){let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"".concat(i.Af,"/auth/connect/").concat(e,"/").concat(null===o||void 0===o?void 0:o.userName,"/").concat(l?"disconnect":"","?returnUrl=").concat(window.location.href)},F=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:14;return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(0,S.jsx)(c.Z,{className:"color-0AB6B6",style:{fontSize:e||14}}):(0,S.jsx)(r.Z,{className:"color-red",style:{fontSize:e||14}})},U=function(){var e,l;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C;const t=p(n)||{},i=a.W[n],r=n===C?"facebook":"linkedin",{isConnected:d=!1,page:v={},group:m={}}=t,f=e=>{var o;let{subTitle:l,item:s}=e;const{socialId:n="",accounts:t=[],askToChoose:a=!1}=s||{},c=!1===a&&n?"(".concat(null===(o=t.find((e=>{let{id:o}=e;return o===n})))||void 0===o?void 0:o.name,")"):"",r=0===(null===t||void 0===t?void 0:t.length)&&s;return(0,S.jsxs)(N,{className:"capitalize",children:[i," ",l," ",c," ",r&&s&&"(No accounts found)"]})},j=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=null===e||void 0===e?void 0:e.map((e=>{let{id:i,name:a}=e;return{key:i,label:a,icon:t===i?(0,S.jsx)(c.Z,{}):null,onClick:()=>(async(e,l,n,t)=>{y(!0);try{await s.Z.get("users/".concat(null===o||void 0===o?void 0:o._id,"/connect/").concat(e,"/").concat(l,"/").concat(n));const i={...o,socialAccounts:((null===o||void 0===o?void 0:o.socialAccounts)||[]).map((o=>o.type!==e?o:{...o,[l]:{...o[l],socialId:n,askToChoose:!1}}))};u({user:i}),x.ZP.success({message:"Success",description:"".concat(l,' "').concat(t,'" connected successfully.')})}catch(i){console.log(i),x.ZP.error({message:"Error",description:null===i||void 0===i?void 0:i.msg})}finally{y(!1)}})(n,l,i,a),className:t===i?"pointer-none color-white color-0AB6B6 bg-F4F6F8":""}}));return[{key:"header",type:"group",label:"Select ".concat(l," for automation")},...i]},{accounts:w=[],socialId:k=""}=v,{accounts:Z=[],socialId:I=""}=m,P=(null===w||void 0===w?void 0:w.length)>1?j(w,"page",k):null,T=(null===Z||void 0===Z?void 0:Z.length)>1?j(Z,"group",I):null,_=[{key:"profile",className:"pointer-none",icon:F(d),label:(0,S.jsx)(f,{subTitle:"Profile"})},{key:"page",children:P,disabled:0===(null===v||void 0===v||null===(e=v.accounts)||void 0===e?void 0:e.length),className:P?"":"pointer-none",label:(0,S.jsx)(f,{subTitle:"Page",item:v}),icon:F(d&&k&&!1===(null===v||void 0===v?void 0:v.askToChoose))},{key:"group",children:T,disabled:0===(null===m||void 0===m||null===(l=m.accounts)||void 0===l?void 0:l.length),className:T?"":"pointer-none",label:(0,S.jsx)(f,{subTitle:"Group",item:m}),icon:F(d&&I&&!1===(null===m||void 0===m?void 0:m.askToChoose))}];return[{type:"group",key:"account",label:"Connected Accounts",children:n===C?_:_.filter((e=>"group"!==e.key))},{key:"divider",type:"divider"},{key:"reconect-disconnnect",label:(0,S.jsxs)("div",{className:"flex-item",children:[(0,S.jsx)(b.ZP,{block:!0,danger:!0,icon:(0,S.jsx)(h,{}),onClick:()=>(async e=>{y(!0);try{await s.Z.get("users/".concat(null===o||void 0===o?void 0:o._id,"/disconnect/").concat(e));const l={...o,socialAccounts:((null===o||void 0===o?void 0:o.socialAccounts)||[]).map((o=>o.type!==e?o:{...o,isConnected:!1}))};u({user:l}),x.ZP.success({message:"Success",description:"Account disconnected successfully."})}catch(l){console.log(l),x.ZP.error({message:"Error",description:null===l||void 0===l?void 0:l.msg})}finally{A(null),y(!1)}})(n),children:"Disconnect"}),(0,S.jsx)(b.ZP,{block:!0,type:r,icon:(0,S.jsx)(g,{}),href:q(r),children:"Reconnect"})]})}]},z=[{key:"facebook",disabled:!1,title:"Facebook",items:U(C),isConnected:O(C)},{key:"linkedin",disabled:!1,title:"LinkedIn",items:U(I),isConnected:O(I)}];return(0,S.jsxs)("div",{className:"social-media ".concat(l),children:[d&&(0,S.jsx)(Z,{level:3,children:"Connect with social media"}),(0,S.jsx)(j.Z,{size:16,children:z.map((e=>{let{key:o,title:l,items:s,disabled:t,isConnected:i}=e;return(0,S.jsx)(w.Z,{arrow:!0,placement:"top",disabled:!i,open:_===o,menu:{items:s,defaultOpenKeys:P},onOpenChange:e=>{!e&&P.length?(T([]),setTimeout((()=>A(e?o:null)),120)):A(e?o:null)},children:(0,S.jsx)(k.Z,{count:F(i,"large"===v?32:26),children:(0,S.jsxs)(b.ZP,{type:o,size:v,shape:"round",loading:f,disabled:t,href:q(o),icon:(0,S.jsx)(n.Z,{name:o}),className:i?"pointer-none":"",children:[i?"Connected":"Connect"," with ",l]})})},o)}))})]})}},46417:(e,o,l)=>{l.d(o,{Z:()=>m});var s=l(85379),n=l(18406),t=l(29966),i=l(93070),a=l(89862),c=l(97412),r=l(61431),d=l(2556),u=l(71234),v=l(80184);function m(){const e=i.Z.useFormInstance(),o=i.Z.useWatch("socials",e)||[],l=[4,3,2,1].map((e=>({value:e,label:"Post [".concat(e,"x] monthly")}))),m=(l,s,n)=>{const t=o.map((e=>e._id===l?{...e,[s]:n}:e));e.setFieldValue("socials",t)},h=o.length>0,p=[{key:"social",label:"Confirm Socials & Posting Frequency",children:(0,v.jsxs)("div",{className:"flex-item gap-1 flex-column align-baseline",children:[(0,v.jsx)(i.Z.Item,{name:"socials",hidden:!0,children:(0,v.jsx)("input",{})}),h&&o.map((e=>{let{_id:o,type:s,subType:i,subTypeName:u="",isActive:h,frequency:p,isConnected:f}=e;return(0,v.jsxs)("div",{className:"flex-item gap-1 flex-auto",children:[(0,v.jsx)(a.Z,{checked:h,className:"uppercase",disabled:!f,onChange:e=>m(o,"isActive",e.target.checked),children:(0,n.dh)(s,i,u)}),(0,v.jsx)(c.default,{size:"small",defaultValue:4,value:p,placeholder:"Select",disabled:!f,options:l,style:{minWidth:200},onChange:e=>m(o,"frequency",e)}),!f&&(0,v.jsx)(r.Z,{color:"red",arrow:!1,title:"Please connect your social account to enable this automation.",children:(0,v.jsxs)(d.ZP,{danger:!0,type:"text",size:"small",shape:"circle",icon:(0,v.jsx)(t.Z,{}),children:["Account Disconnected"," "]})})]},o)})),!h&&(0,v.jsx)(u.Z,{showIcon:!0,style:{fontWeight:600},message:"No social media accounts found. Please connect your social media accounts first."})]})}];return(0,v.jsx)(s.Z,{items:p,defaultActive:"social",marginBottom:!1})}},18406:(e,o,l)=>{l.d(o,{K6:()=>g,MD:()=>y,Qg:()=>h,Ug:()=>p,dh:()=>f,fh:()=>m,mr:()=>v});var s=l(25415),n=l(908);const{FACEBOOK:t}=n.SOCIAL_TYPE,{HOST_GUEST:i,SOLO_SESSION:a}=n.GUEST_TYPE,{PROFILE:c,PAGE:r,GROUP:d}=n.SOCIAL_SUB_TYPE,u=["##E91E63","#673AB7","#2196F3","#00BCD4","#FF9800","#8BC34A","#009688","#FF5722","#607D8B","#F44336"],v=()=>u[Math.floor(Math.random()*u.length)],m=e=>new Date(e).toDateString(),h=[{key:i,value:i,label:"JOINT SESSION",text:"Their Info"},{key:a,value:a,label:"SOLO SESSION",text:"Your Info"}],p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return h.find((o=>o.key===e))},f=function(e,o){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const s=(e=>n.W[e])(e);return o===c?"YOUR ".concat(s," PROFILE"):o===r?"YOUR ".concat(s," PAGE: ").concat(l):o===d?"YOUR ".concat(s," GROUP: ").concat(l):""},g=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(((e,o)=>{if(null===o||void 0===o||!o.isConnected)return e;const{type:l,socialId:s,page:n,group:i}=o,a=function(e,o){return{type:l,subType:e,frequency:arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,subTypeId:o,subTypeName:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",isActive:!1,_id:"".concat(l,"_").concat(e),isConnected:(o||"").toString().length>0}},u=e=>{var o;return(null===e||void 0===e||null===(o=e.accounts.find((o=>{let{id:l}=o;return l===(null===e||void 0===e?void 0:e.socialId)})))||void 0===o?void 0:o.name)||""},v=[...e,a(c,s),a(r,null===n||void 0===n?void 0:n.socialId,u(n))];return l===t?[...v,a(d,null===i||void 0===i?void 0:i.socialId,u(n))]:v}),[])},y=e=>{const o=new s.Workbook,l=o.addWorksheet("Voting Data"),{questionnaireAnswers:n=[]}=e[0]||{},[t,i,a,c]=n;l.columns=[{header:"Selected Topic",key:"topic"},{header:"Voter Name",key:"voter_name"},{header:"Voter Email",key:"voter_email"},{header:"Voter Cell Phone",key:"voter_cellphone"},{header:"User Suggested",key:"isSuggestion"},{header:"Suggested Topic",key:"suggested_topic"},{header:"Suggested Speaker",key:"suggested_speaker"},{header:"Question 1: ".concat(null===t||void 0===t?void 0:t.question),key:"quest1"},{header:"Question 2: ".concat(null===i||void 0===i?void 0:i.question),key:"quest2"},{header:"Referral 1",key:"quest2_referral1"},{header:"Referral 2",key:"quest2_referral2"},{header:"Name",key:"quest2_name"},{header:"Email",key:"quest2_email"},{header:"Question 3: ".concat(null===a||void 0===a?void 0:a.question),key:"quest3"},{header:"Question 4: ".concat(null===c||void 0===c?void 0:c.question),key:"quest4"},{header:"Timestamp",key:"timestamp"}],e.forEach((e=>{var o,s,n,t,i,a;const{selectedTopic:c,voter:r,isSuggestion:d,suggestions:u,createdAt:v,questionnaireAnswers:m}=e,[h,p,f,g]=m;l.addRow({topic:(null===c||void 0===c?void 0:c.topic)||"Other",voter_name:(null===r||void 0===r?void 0:r.name)||"--",voter_email:(null===r||void 0===r?void 0:r.email)||"--",voter_cellphone:(null===r||void 0===r?void 0:r.cell_phone)||"--",isSuggestion:d?"Yes":"No",suggested_topic:(null===u||void 0===u?void 0:u.topic)||"--",suggested_speaker:(null===u||void 0===u?void 0:u.speaker)||"--",quest1:h&&(null===h||void 0===h?void 0:h.answers)||"--",quest2:null!==p&&void 0!==p&&p.answers?"Comment: ".concat((null===p||void 0===p||null===(o=p.answers)||void 0===o?void 0:o.comment)||"--"):"--",quest2_referral1:(null===p||void 0===p||null===(s=p.answers)||void 0===s?void 0:s.referral1)||"--",quest2_referral2:(null===p||void 0===p||null===(n=p.answers)||void 0===n?void 0:n.referral2)||"--",quest2_name:(null===p||void 0===p||null===(t=p.answers)||void 0===t?void 0:t.name)||"--",quest2_email:(null===p||void 0===p||null===(i=p.answers)||void 0===i?void 0:i.email)||"--",quest3:f&&(null===f||void 0===f||null===(a=f.answers)||void 0===a?void 0:a.answer)||"--",quest4:g?null!==g&&void 0!==g&&g.doneSharing?"Yes":"No":"--",timestamp:new Date(v).toLocaleString()})})),o.xlsx.writeBuffer().then((e=>{const o=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=window.URL.createObjectURL(o),s=document.createElement("a");s.href=l,s.download="VotingData.xlsx",s.click()}))}}}]);
//# sourceMappingURL=6.d77554e7.chunk.js.map